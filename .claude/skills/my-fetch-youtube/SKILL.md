---
name: my-fetch-youtube
description: YouTube URL을 받으면 자막을 추출하고, Web Search로 자동자막 오류를 보정한 뒤, 요약-인사이트-전체 번역을 제공하는 스킬. "유튜브 번역", "영상 정리", "YouTube 요약" 요청에 사용.
---

# my-fetch-youtube

## Step 1: 자막 추출 + 정제

### yt-dlp로 자막 추출

아래 명령어로 영상을 다운로드하지 않고 자막만 추출한다.

```bash
yt-dlp --write-auto-sub --sub-lang "ko,en" --skip-download --convert-subs vtt -o "%(title)s" "{URL}"
```

각 옵션 설명:
- `--write-auto-sub`: 자동 생성 자막도 포함
- `--sub-lang "ko,en"`: 한국어와 영어 자막 요청
- `--skip-download`: 영상 다운로드 안 함 (자막만)
- `--convert-subs vtt`: VTT 형식으로 변환
- `-o "%(title)s"`: 영상 제목으로 파일명 지정

### 자막 언어 우선순위

여러 자막이 존재할 경우 아래 순서로 선택한다:

| 우선순위 | 자막 종류 | 설명 |
|----------|----------|------|
| 1순위 | 한국어 수동 자막 | 사람이 직접 작성 (가장 정확) |
| 2순위 | 영어 수동 자막 | 사람이 직접 작성 |
| 3순위 | 한국어 자동 자막 | AI 생성 (오류 가능) |
| 4순위 | 영어 자동 자막 | AI 생성 (오류 가능) |

### VTT → 순수 텍스트 정제

추출된 VTT 자막 파일에는 타임스탬프, 번호, HTML 태그 등이 섞여 있다. 아래 파이프라인으로 순수 텍스트만 추출한다.

```bash
sed -E 's/^[0-9]+$//' | sed -E 's/[0-9]{2}:[0-9]{2}:[0-9]{2}.*//g' | sed -E 's/<[^>]+>//g' | tr -s '\n' | grep -v '^$'
```

각 단계:
1. `sed -E 's/^[0-9]+$//'` — 자막 번호 제거
2. `sed -E 's/[0-9]{2}:[0-9]{2}:[0-9]{2}.*//g'` — 타임스탬프 제거
3. `sed -E 's/<[^>]+>//g'` — HTML 태그 제거
4. `tr -s '\n'` — 연속 빈 줄 압축
5. `grep -v '^$'` — 빈 줄 제거

### 자막이 없는 경우

자막을 추출할 수 없을 때는 아래 안내를 출력하고 종료한다:

```
⚠️ 이 영상에는 자막이 없습니다.
자막(수동 또는 자동)이 있는 다른 영상을 선택해주세요.
```

## Step 2: 메타데이터 추출

### yt-dlp로 메타데이터 가져오기

영상의 제목, 설명, 채널 등 정보를 JSON으로 추출한다.

```bash
yt-dlp --dump-json --no-download "{URL}"
```

### 추출할 필드

| 필드 | JSON 키 | 설명 |
|------|---------|------|
| 영상 제목 | `title` | 영상 이름 |
| 영상 설명 | `description` | 업로더가 작성한 설명란 |
| 채널명 | `channel` | 유튜브 채널 이름 |
| 영상 길이 | `duration` | 초 단위 (예: 1800 = 30분) |
| 챕터 | `chapters` | 영상 내 구간 목록 (있는 경우) |

### 메타데이터 활용

- `title` + `description`에서 키워드를 추출하여 Step 3(Web Search 보정)에 활용
- `chapters`가 있으면 번역 시 챕터별로 구분하여 가독성 향상
- `duration`으로 영상 길이를 파악하여 긴 영상(10분 이상)은 Task Agent 사용을 권장

## Step 3: Web Search 보정 (핵심)

자동 자막은 AI가 음성을 텍스트로 변환한 것이라 고유명사, 전문 용어, 약어가 틀릴 수 있다. 영상 메타데이터에서 키워드를 추출하고 웹 검색으로 올바른 표기를 확인하여 보정한다.

### 3-1: 키워드 추출 (5-10개)

영상 `title`과 `description`에서 아래 유형의 키워드를 추출한다:

| 유형 | 예시 |
|------|------|
| 고유명사 (사람 이름) | Dario Amodei, Andrej Karpathy |
| 고유명사 (회사/제품명) | Anthropic, OpenAI, Claude |
| 전문 용어 | Fine-tuning, Reinforcement Learning |
| 약어 | LLM, RAG, RLHF, MCP |

### 3-2: WebSearch 병렬 실행

추출한 키워드로 WebSearch를 **병렬 호출**하여 정확한 표기를 확인한다.

검색 쿼리 패턴:
- `"{사람 이름}" {회사명}` — 인물의 정확한 이름과 소속 확인
- `"{전문 용어}" explained` — 용어의 정확한 표기 확인
- `"{약어}" stands for` — 약어의 풀네임 확인

### 3-3: 자동 자막 보정

검색 결과를 바탕으로 자막 텍스트에서 잘못된 부분을 찾아 수정한다.

보정 기준:
- **고유명사 오류**: 비슷한 발음의 다른 단어로 인식된 경우
- **전문 용어 오류**: 일반 단어로 잘못 변환된 경우
- **약어 오류**: 철자가 틀리거나 풀어쓴 경우

### 보정 전/후 예시

```
🔧 자막 보정 내역

| 보정 전 (자동 자막) | 보정 후 | 근거 |
|---------------------|---------|------|
| "Cloud" | "Claude" | Anthropic의 AI 모델명 |
| "앤트로피" | "Anthropic" | AI 안전 연구 기업명 |
| "fine tuning" | "Fine-tuning" | 모델 미세조정 기술 용어 |
| "car pithy" | "Karpathy" | Andrej Karpathy (AI 연구자) |
| "RL HF" | "RLHF" | Reinforcement Learning from Human Feedback |
| "react" | "ReAct" | Reasoning + Acting 프레임워크 |

보정: 6건 수정
```

### 보정 규칙

1. 확실한 오류만 보정한다 (추측으로 바꾸지 않음)
2. 보정 내역을 반드시 기록하여 사용자가 확인할 수 있게 한다
3. 보정 전 원문도 함께 표시하여 투명성을 유지한다

## Step 4: 번역 파이프라인

Step 1~3에서 추출하고 보정한 자막 텍스트를 3단계로 처리한다. 전체 번역을 바로 보여주지 않고, 핵심부터 파악한 뒤 전체를 읽는 순서로 제공한다.

### 긴 영상 처리 (10분 이상)

`duration`이 600초 이상인 영상은 컨텍스트가 매우 길어질 수 있다. 이 경우 **Task Agent**(subagent_type: "general-purpose")를 사용하여 번역 파이프라인을 처리한다.

```
Task({
  subagent_type: "general-purpose",
  prompt: "아래 자막 텍스트를 요약-인사이트-전체 번역 3단계로 처리해줘. (자막 텍스트 전달)"
})
```

10분 미만 영상은 메인 세션에서 바로 처리한다.

### 1단계: 요약 (3-5문장)

영상의 핵심을 30초 만에 파악할 수 있도록 한국어로 요약한다.

포함할 내용:
- 영상의 핵심 주제 또는 메시지
- 채널명과 영상 길이 정보
- 주요 논점 2-3개

출력 형식:
```
📋 요약
[채널명]의 영상 (XX분) — (주제)에 대해 다룬다.
(핵심 내용 2-3문장)
```

### 2단계: 인사이트 (3개)

요약을 바탕으로 더 깊은 분석을 제공한다.

| 인사이트 | 질문 | 설명 |
|----------|------|------|
| 핵심 메시지 | "이 영상이 정말 말하고 싶은 것은?" | 표면적 내용 너머의 핵심 의도 |
| 시사점 | "업계/트렌드에서 어떤 의미인가?" | 더 넓은 맥락에서의 의미 |
| 적용점 | "나(시청자)에게 어떤 의미인가?" | 실제로 활용할 수 있는 포인트 |

출력 형식:
```
💡 인사이트
1. 핵심 메시지: (내용)
2. 시사점: (내용)
3. 적용점: (내용)
```

### 3단계: 전체 번역된 아티클

영상 전체를 읽기 쉬운 아티클 형태로 한국어 번역한다.

번역 규칙:
- 직역이 아닌 자연스러운 한국어로 의역
- 전문 용어는 원문 병기: 예) "파인튜닝(Fine-tuning)", "강화학습(Reinforcement Learning)"
- Step 3에서 보정된 용어를 반드시 사용 (보정 전 표기 사용 금지)
- `chapters`가 있으면 챕터별로 구분하여 소제목 포함
- `chapters`가 없으면 내용 흐름에 따라 자연스럽게 단락 구분

출력 형식 (챕터가 있는 경우):
```
📝 전체 번역

## (챕터 1 제목)
(해당 구간 번역)

## (챕터 2 제목)
(해당 구간 번역)

...
```

출력 형식 (챕터가 없는 경우):
```
📝 전체 번역

(자연스럽게 단락을 나누어 번역한 전체 내용)
```
